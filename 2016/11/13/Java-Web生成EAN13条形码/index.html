<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Java Web生成EAN13条形码 · Bonjour!</title><meta name="description" content="Java Web生成EAN13条形码 - BonjourChen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Bonjour!"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/webinchen" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/bonjourchen" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Java Web生成EAN13条形码</h1><div class="post-info">Nov 13, 2016</div><div class="post-content"><h4 id="EAN13编码原理"><a href="#EAN13编码原理" class="headerlink" title="EAN13编码原理"></a>EAN13编码原理</h4><p>具体详见<a href="http://blog.csdn.net/abcpanpeng/article/details/8130392" target="_blank" rel="external">EAN13编码原理</a>，这里简要概述一下：<br>一个EAN-13条码被划分成了4个区域：1）数制2）厂商码3）商品码4）校验位。通常，第一个数制位被打印在条码的左边，第二个数制位被作为条码下方左手边的那组六位数的第一个字符打印，厂商码是条码下方左手边的后5位数，产品码是条码下方右手边的前五位数，校验位是条码下方右手边的最后一位。<br>以下是典型的EAN-13的条码：<br><img src="http://of9x0sxb3.bkt.clouddn.com/blog/20161113/120007864.png" alt="mark"></p>
<ul>
<li>数制：数制是由2位组成的（有些时候是3位），用来区分国家或经济区域制定厂商码的编码权利。</li>
<li>厂商码：厂商码是由数制码标示的编码管理局为每个厂商分配的一个唯一的编码。一个公司的所有产品将使用相同的厂商码。</li>
<li>产品码：产品码是厂商分配的唯一编码。</li>
<li>校验位：校验位是一个附加的位，用来验证一个条码是否被正确的扫描。扫描可能产生不正确的数据，这可能是由于不一致的扫描速度、不完善的打印或一系列其他的问题造成的，因此，有必要验证条码的其余数据已经被正确的诠释。校验位是从条码中其余的数字位中计算得到的。通常，如果校验位和基于已经扫描得到的数据计算出来的校验位的值相同的话，就可以高度的信任条码已经被正确扫描。<a id="more"></a>
</li>
</ul>
<p>计算校验位的步骤如下：</p>
<ol>
<li>将最右边一个数位作为“奇数”位，从右向左为每个字符指定奇数/偶数位。</li>
<li>对所有奇数位上的数值求和，将结构乘以3。</li>
<li>对所有偶数位上的数值求和。</li>
<li>对第2步和第3步计算的结果求和。</li>
<li>校验位的数字加上用第4步计算的总和数应该能够被10整除。</li>
<li>如果第4步计算的总和数能够被10整除，校验位就是“0”（不是10）</li>
</ol>
<h4 id="JSP代码实现"><a href="#JSP代码实现" class="headerlink" title="JSP代码实现"></a>JSP代码实现</h4><p>生成EAN13条形码的库使用的是jbarcode。下载地址：<a href="https://sourceforge.net/projects/jbcode/" target="_blank" rel="external">jbarcode</a></p>
<ul>
<li>JBarcode是一个使用 了Java 2D API条形码图像创建工具，支持EAN13, EAN8, UPCA, UPCE, Code 3 of 9, Codabar, Code 11, Code 93, Code 128, MSI/Plessey, Interleaved 2 of 5, PostNet等）。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line">&lt;%@ page language="java" contentType="text/html; charset=GB2312"</div><div class="line">    pageEncoding="GB2312"%&gt;</div><div class="line">&lt;%@ page import="java.awt.image.BufferedImage" %&gt;</div><div class="line">&lt;%@ page import="java.io.FileOutputStream" %&gt;</div><div class="line">&lt;%@ page import="java.io.File" %&gt;</div><div class="line">&lt;%@ page import="org.jbarcode.JBarcode" %&gt;</div><div class="line">&lt;%@ page import="org.jbarcode.util.ImageUtil" %&gt;</div><div class="line">&lt;%@ page import="org.jbarcode.encode.EAN13Encoder" %&gt;</div><div class="line">&lt;%@ page import="org.jbarcode.encode.InvalidAtributeException" %&gt;</div><div class="line">&lt;%@ page import="org.jbarcode.paint.EAN13TextPainter" %&gt;</div><div class="line">&lt;%@ page import="org.jbarcode.paint.WidthCodedPainter" %&gt;</div><div class="line"></div><div class="line">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv="Content-Type" content="text/html; charset=GB2312"&gt;</div><div class="line">&lt;title&gt;EAN-13编码&lt;/title&gt;</div><div class="line">&lt;style&gt;</div><div class="line">td&#123;</div><div class="line">	background-color:#eeeeee</div><div class="line">	&#125;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line"></div><div class="line">	&lt;table border="0" cellpadding="0" cellspacing="2" bgcolor="white" width="410" style="border-right: #000000 1px solid; border-top: #000000 1px solid; font-size: 12px; border-left: #000000 1px solid; border-bottom: #000000 1px solid" ID="Table1"&gt;</div><div class="line">		&lt;tr height="20"&gt;</div><div class="line">			&lt;td width="90"&gt;12位条码数字&lt;/td&gt;</div><div class="line">			&lt;td&gt;</div><div class="line">				&lt;form action="." method="post"&gt;</div><div class="line">				&lt;%</div><div class="line">				String serial = (String)request.getParameter("ipt_12");</div><div class="line">				if(serial == null)</div><div class="line">					serial = "123456789012";</div><div class="line">				String serial_ns = "";</div><div class="line">				String serial_mc = "";</div><div class="line">				String serial_mc_1 = "";</div><div class="line">				String serial_pc = "";</div><div class="line">				String serial_pc_1 = "";</div><div class="line">				String serial_cd = "";</div><div class="line">				String serial_cd_1 = "";</div><div class="line">				String jpg_ean = "";</div><div class="line">				%&gt;</div><div class="line">				&lt;input id="ipt_12" size="12" maxlength="12" value="&lt;%=serial %&gt;" name="ipt_12"&gt;&lt;input id="make" type="submit" value="生成条码" name="make"&gt;</div><div class="line">				&lt;a href="http://blog.csdn.net/FuWaer/archive/2007/09/03/1770317.aspx" target=_blank&gt;EAN-13编码规则&lt;/a&gt;</div><div class="line">				&lt;/form&gt;</div><div class="line">				&lt;% serial = (String)request.getParameter("ipt_12");</div><div class="line">					if(serial != null &amp;&amp; serial.length() == 12)&#123;</div><div class="line">						serial_ns = serial.substring(0,2);</div><div class="line">						serial_mc = serial.substring(2,7);</div><div class="line">						serial_mc_1 = "__" + serial.substring(2,7);</div><div class="line">						serial_pc = serial.substring(7,12);</div><div class="line">						serial_pc_1 = "_______" + serial.substring(7,12);</div><div class="line">						int a = 0;</div><div class="line">						int b = 0;</div><div class="line">						for(int i = 0; i &lt; 12; i++)&#123;</div><div class="line">							if(i%2 == 0)&#123;</div><div class="line">								char c = serial.charAt(i);</div><div class="line">								int x = c - '0';</div><div class="line">								a += x;</div><div class="line">							&#125;else&#123;</div><div class="line">								char d = serial.charAt(i);</div><div class="line">								int y = d - '0';</div><div class="line">								b += y*3;</div><div class="line">							&#125;</div><div class="line">						&#125;</div><div class="line">						int src = 10 - (a + b)%10;</div><div class="line">						serial_cd = src + "";</div><div class="line">						serial_cd_1 = "____________" + src;</div><div class="line">						</div><div class="line">						String path = application.getRealPath(request.getRequestURI());</div><div class="line">						String dir = new File(path).getParent();</div><div class="line">						String jpg_ean_filepath = dir + "\\EAN13.jpg";</div><div class="line">						File file = new File(jpg_ean_filepath);</div><div class="line">						if(file.exists())</div><div class="line">							file.delete();</div><div class="line">						JBarcode jbarcode = new JBarcode(EAN13Encoder.getInstance(), WidthCodedPainter.getInstance(), EAN13TextPainter.getInstance());</div><div class="line">						BufferedImage localBufferedImage = jbarcode.createBarcode(serial);</div><div class="line">						FileOutputStream localFileOutputStream = new FileOutputStream(jpg_ean_filepath);</div><div class="line">						ImageUtil.encodeAndWrite(localBufferedImage, "jpeg", localFileOutputStream, 96, 96); </div><div class="line">						localFileOutputStream.close();</div><div class="line">						jpg_ean = "&lt;img src=\"" + "EAN13.jpg" + "\" height=90%; width=100%;&gt;";</div><div class="line">					&#125;else if(serial != null &amp;&amp; serial.length() != 12)&#123;</div><div class="line">						out.println("&lt;script&gt;alert('Please enter 12 digits!')&lt;/script&gt;");</div><div class="line">					&#125;</div><div class="line">				%&gt;</div><div class="line">			&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr height="20"&gt;</div><div class="line">			&lt;td width="90"&gt;13位EAN-13条码&lt;/td&gt;</div><div class="line">			&lt;td id="td13" style="font-weight: bold; font-size: 14px; letter-spacing: 5px"&gt;&lt;font color=red&gt;&lt;%=serial_ns%&gt;&lt;/font&gt;&lt;font color=blue&gt;&lt;%=serial_mc%&gt;&lt;/font&gt;&lt;font color=brown&gt;&lt;%=serial_pc%&gt;&lt;/font&gt;&lt;font color=green&gt;&lt;%=serial_cd%&gt;&lt;/font&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr height="20"&gt;</div><div class="line">			&lt;td width="90"&gt;数制码&lt;/td&gt;</div><div class="line">			&lt;td id="td13_ns" style="font-weight: bold; font-size: 14px; letter-spacing: 5px; color:red"&gt;&lt;%=serial_ns%&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr height="20"&gt;</div><div class="line">			&lt;td width="90"&gt;厂商码&lt;/td&gt;</div><div class="line">			&lt;td id="td13_mc" style="font-weight: bold; font-size: 14px; letter-spacing: 5px; color:blue"&gt;&lt;%=serial_mc_1%&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr height="20"&gt;</div><div class="line">			&lt;td width="90"&gt;产品码&lt;/td&gt;</div><div class="line">			&lt;td id="td13_pc" style="font-weight: bold; font-size: 14px; letter-spacing: 5px; color:brown"&gt;&lt;%=serial_pc_1%&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr height="20"&gt;</div><div class="line">			&lt;td width="90"&gt;校验位&lt;/td&gt;</div><div class="line">			&lt;td id="td13_cd" style="font-weight: bold; font-size: 14px; letter-spacing: 5px; color:green"&gt;&lt;%=serial_cd_1%&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr height="140"&gt;</div><div class="line">			&lt;td width="90"&gt;EAN-13图像&lt;/td&gt;</div><div class="line">			&lt;td id="td13_ean" align=center valign=middle style="background-color:white"&gt;&lt;%=jpg_ean %&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">	&lt;/table&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>项目部署在Tomcat7.0上。运行之后如下图：<br><img src="http://of9x0sxb3.bkt.clouddn.com/blog/20161113/120601091.png" alt="mark"></p>
</div></article></div></main><footer><div class="paginator"><a href="/2016/11/15/Docker学习笔记（一）/" class="prev">PREV</a><a href="/2016/11/08/python练手-删除文件夹下的pdf文件/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://yoursite.com">BonjourChen</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>